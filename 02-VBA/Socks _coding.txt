Sub stockAnalysis()     Dim ws As Worksheet          ' Set a variable for specifying the column of interest     Dim stock_ticker As String     Dim i As Double         'set initial variable for holding the total volume per stock     Dim volume_total As Double               ' summary table row     Dim summary_table_row As Long             ' Variable for last row in worksheet     Dim last_row As Double              'Variable for Yearly change     Dim final_close As Double     Dim first_open As Double     Dim yearly_change As Double     Dim percent_change As Double          ' 2nd table     Dim max_increase_ticker As String     Dim max_increase As Double     Dim min_increase_ticker As String     Dim min_increase As Double     Dim max_volume_ticker As String     Dim max_volume As Double          For Each ws In Worksheets       ' MsgBox (ws.Name)             last_row = ws.Cells(Rows.Count, 1).End(xlUp).Row        volume_total = 0                first_open = ws.Cells(2, 3).Value                summary_table_row = 2                           'title         ws.Cells(1, 9).Value = "Stock Ticker"         ws.Cells(1, 10).Value = "Yearly Change"         ws.Cells(1, 11).Value = "Percent Change"         ws.Cells(1, 12).Value = "Volume Total"                  '2nd table         ws.Cells(2, 15).Value = "Greatest % Increase"         ws.Cells(3, 15).Value = "Greatest % Decrease"         ws.Cells(4, 15).Value = "Greatest Total Volume"                  ws.Cells(1, 16).Value = "Ticker"         ws.Cells(1, 17).Value = "Value"                 ' Loop through rows in the column         For i = 2 To last_row                     ' Searches for when the value of the next cell is different than that of the current cell            If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then                            ' Message Box the value of the current cell and value of the next cell                                ' MsgBox (Cells(i, 1).Value)                               ' Closing Price                final_close = ws.Cells(i, 6).Value                                ' still need the amount                                volume_total = volume_total + ws.Cells(i, 7).Value                yearly_change = final_close - first_open                                If first_open = 0 Then                    percent_change = 0                                    Else                    percent_change = Round(yearly_change / first_open * 100, 2)                End If                                ' write to summary table - stock Ticker                                stock_ticker = ws.Cells(i, 1).Value                                ws.Cells(summary_table_row, 9).Value = stock_ticker                ws.Cells(summary_table_row, 10).Value = yearly_change                ws.Cells(summary_table_row, 11).Value = percent_change                ws.Cells(summary_table_row, 12).Value = volume_total                                ' highlight colors                    If yearly_change > 0 Then                        ws.Cells(summary_table_row, 10).Interior.ColorIndex = 4                    Else                        ws.Cells(summary_table_row, 10).Interior.ColorIndex = 3                    End If                                ' reset total charges                                summary_table_row = summary_table_row + 1                volume_total = 0                              ' open price of next cell                first_open = ws.Cells(i + 1, 3).Value                            Else                volume_total = volume_total + ws.Cells(i, 7).Value           End If              Next i             max_increase = 0        min_increase = 0        max_volume = 0                 For k = 2 To ws.Cells(Rows.Count, 9).End(xlUp).Row               If (ws.Cells(k, 11).Value > max_increase) Then                   max_increase = ws.Cells(k, 11).Value                   max_increase_ticker = ws.Cells(k, 9).Value                End If                                 If (ws.Cells(k, 11).Value < min_increase) Then                   min_increase = ws.Cells(k, 11).Value                   min_increase_ticker = ws.Cells(k, 9).Value                End If                                If (ws.Cells(k, 12).Value > max_volume) Then                   max_volume = ws.Cells(k, 12).Value                   max_volume_ticker = ws.Cells(k, 9).Value                End If                            Next k                        ws.Cells(2, 16).Value = max_increase_ticker            ws.Cells(2, 17).Value = max_increase            ws.Cells(3, 16).Value = min_increase_ticker            ws.Cells(3, 17).Value = min_increase            ws.Cells(4, 16).Value = max_volume_ticker            ws.Cells(4, 17).Value = max_volume               NextEnd Sub